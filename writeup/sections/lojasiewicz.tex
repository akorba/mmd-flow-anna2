\subsection{A rate of convergence for the continuous flow}\label{sec:Lojasiewicz_inequality}\manote{maybe discuss the optimality condition and provide simpler proof of convergence when kernel satisfies linearity assumption}
By \cref{prop:decay_mmd} we know that $t\mapsto\mathcal{F}(\nu_t)$ decreases in time, thus a natural question is to ask whether it converges to $0$. One strategy is to find an upper-bound on $\F(\nu_t)$ in terms of the absolute value of its time derivative. Such type of inequalities are known in the optimization literature as Lojasiewicz inequalities (see \cite{Bolte:2016}).
This would provide a differential inequality which can be solved using the so called Gronwall's lemma. The solution of such inequality would be of the form $\F(\nu_t)\leq h(t)$ with $h(t)\rightarrow_{t\rightarrow \infty} 0$. Hence one can deduce the convergence of $\F(\nu_t)$ to the global minimizer and get estimates of the rate of convergence by means of $h(t)$.
According to \cref{prop:decay_mmd}, the absolute value of the time derivative of $\F(\nu_t)$ is given by $\int \Vert \nabla f_{\mu,\nu_t}(x) \Vert^2 \diff \nu_t(x)$. This is nothing but the squared \textit{weighted Sobolev semi-norm} of $f_{\mu,\nu_t}$ also denoted as $\Vert f_{\mu,\nu_t} \Vert_{\dot{H}(\nu_t)}$ \footnote{Given a probability distribution $\nu$ the \textit{weighted Sobolev semi-norm} is defined for all squared integrable functions $f$ in $L_2(\nu)$ as $ \Vert f \Vert_{\dot{H}(\nu)} = \left(\int \Vert \nabla f(x) \Vert^2 \diff \nu(x) \right)^{\frac{1}{2}}$ with the convention $\Vert f \Vert_{\dot{H}^1(\nu)} = +\infty$ if $f$ doesn't have a square integrable gradient.}. Thus one needs to find a relationship between $\F(\nu_t) = \frac{1}{2} \Vert f_{\mu,\nu_t} \Vert_{\mathcal{H}}^2 $ and $\Vert f_{\mu,\nu_t} \Vert_{\dot{H}^1(\nu_t)}$. For this purpose, we consider a distance on $\mathcal{P}_2(\X)$ defined by duality using $\Vert . \Vert_{\dot{H}(\nu)}$:
\begin{definition}\label{def:neg_sobolev}
(\textit{weighted negative Sobolev distance},\cite{Peyre:2011})
	Given a probability distribution $\nu\in \mathcal{P}_2(\x)$ and it's corresponding \textit{weighted Sobolev semi-norm} $ \Vert . \Vert_{\dot{H}(\nu)} $ defined on $L_2(\nu)$, the \textit{weighted negative Sobolev distance} $\Vert p - q \Vert_{\dot{H}^{-1}(\nu)}$ between any $p$ and $q$ in $\mathcal{P}_2(\x)$  is defined as:
\begin{align}\label{eq:neg_sobolev}
	\Vert p - q \Vert_{\dot{H}^{-1}(\nu)} = \sup_{f\in L_2(\nu), \Vert f \Vert_{\dot{H}(\nu)} \leq 1 } \left\vert \int f(x)\diff p(x) - \int f(x)\diff q(x) \right\vert 
\end{align}	
with possibly infinite values.
\end{definition}
\cref{eq:neg_sobolev} plays a fundamental role in dynamic optimal transport. Indeed, when $q$ is equal to $\nu$, it linearizes the $W_2(p,\nu)$ as $p$ becomes arbitrarily close to $\nu$ \cite{Villani:2009,Otto:2000,Peyre:2011}. It can also be seen as the minimum kinetic energy needed to advect the mass $\nu$ to $q$ (see \cite{mroueh2018regularized}).

%Whenever $\Vert \mu - \nu_t \Vert_{\dot{H}^{-1}(\nu_t)} $ is bounded by some positive constant $C$ at all times $t$ one can get a functional version of Lojasiewicz inequality:

Whenever $\Vert \mu - \nu_t \Vert_{\dot{H}^{-1}(\nu_t)} $ is finite and since $f_{\mu,\nu_t}$ is itself square-integrable w.r.t $\nu_t$ (by assumption on the kernel), it can be shown that:
\begin{align}\label{eq:inequality_neg_sobolev}
	\Vert f_{\mu,\nu_t} \Vert^2_{\mathcal{H}} \leq \Vert f_{\mu,\nu_t} \Vert_{\dot{H}(\nu_t)} \Vert  \mu -\nu_t\Vert_{\dot{H}^{-1}(\nu_t)}  
\end{align}
Hence, provided that $\Vert \mu - \nu_t \Vert_{\dot{H}^{-1}(\nu_t)} $ remains bounded by some positive constant $C$ at all times, one gets a functional version of Lojasiewicz inequality:
\begin{align}\label{eq:Lojasiewicz_inequality}
	4\F(\nu_t)^2\leq C^2 \int \Vert \nabla f_{\mu,\nu_t} \Vert^2 \diff \nu_t(x)  \qquad \forall t\geq 0.
\end{align} 
It is then possible to use the general strategy explained earlier to prove the convergence of the flow to a global optimum. This is summarized in \cref{prop:lojasiewicz}:
\begin{proposition}\label{prop:lojasiewicz}
	Assume that $\Vert \mu - \nu_t \Vert_{\dot{H}^{-1}(\nu_t)} \leq C$ at all times $t\geq 0$ then $\F(\nu_t)$ converges to $0$ and satisfies:
	\begin{align}
	\mathcal{F}(\nu_t)\leq \frac{C}{C\mathcal{F}(\nu_0)^{-1} + 4t}
	\end{align}
\end{proposition}
The fact that \cref{eq:neg_sobolev}, which is a linearization of the Wasserstein distance appears in the context of Wasserstein flows is not a coincidence. In fact, other gradient flows of the same functional $\F$ under a different metric, would lead to an inequality similar to \cref{eq:Lojasiewicz_inequality}. The only difference come from the different linearization that arises from that choice of metric. For instance, in \cite{Rotskoff:2019}, a gradient flow of functionals similar to $\F$ is considered under a hybrid metric (a mixture between the Wasserstein distance and KL divergence). Convergence rates can then be obtained provided that $\chi^2(\mu\Vert \nu_t)$ is bounded, which turns out to approximate $KL(\mu\Vert \nu_t)$ when $\mu$ and $\nu_t$ are close as shown in \manote{add some appendix section}.

Under similar conditions as in \cref{prop:lojasiewicz}, convergence of the discrete-time flow can be obtained:
\begin{proposition}\label{prop:discrete_lojasiewicz}
	Assume that $\Vert \mu - \nu_n \Vert_{\dot{H}^{-1}(\nu_n)} \leq C$ for all $n\geq 0$, where $\nu_n$ are defined in \cref{eq:euler_scheme} then $\F(\nu_n)$ converges to $0$ and satisfies:\aknote{L is the lipschitz constant of $\nabla f$?}
	\begin{align}
	\mathcal{F}(\nu_n)\leq \frac{C}{C\mathcal{F}(\nu_0)^{-1} + 4 \gamma(1-\gamma L) n}
	\end{align}
\manote{add a proof for this}
\end{proposition}
Proofs of \cref{prop:lojasiewicz,prop:discrete_lojasiewicz} are direct consequences of \cref{prop:decay_mmd,prop:decreasing_functional} and the bounded energy assumption, see  \cref{proof:prop:lojasiewicz} for a proof.
In practice, it is hard to guarantee that $\Vert \mu - \nu_t \Vert_{\dot{H}^{-1}(\nu_t)} $ remains bounded at all times. One possible approach could be to regularize $\F$ using an estimate of \cref{eq:neg_sobolev}. In fact \cite{Mroueh:2019} consider the gradient flow of a regularized version of the negative Sobolev distance which can be written in closed-form, and shows that it decreases the MMD. Combing both losses could improve the overall convergence properties of the MMD for an additional computational cost. In \cref{sec:noisy_flow} we propose a different approach to improve the convergence, but we first analyze in \cref{subsection:barrier_optimization} the case where $\F$ is only guaranteed to reach a barrier during optimization.
%All the difficulty is to see now when \cref{eq:bounded_neg_sobolev} holds. However, this quantity might be infinite \manote{say exactly when it is finite} and a fundamental problem would be to control its value during the evolution of the flow. One possible strategy would be to start from initial $\nu_0$ such that $\Vert \nu_0  - \mu \Vert_{\dot{H}^{-1}(\nu_0)} \leq C $  for some finite positive value $C$ and then show that this property is preserved during the dynamics. For instance, it would be satisfied if $\mu \ll \nu_0$ and if this remains true along the flow. Another view on the problem would be to consider a time depended constant $C_t$ in \cref{eq:bounded_neg_sobolev}, such that $	\lim_{t\rightarrow +\infty} \int_0^t C_s^{-1}\diff s = +\infty$.
%\begin{align}
%	\lim_{t\rightarrow +\infty} \int_0^t C_s^{-1}\diff s = +\infty
%\end{align}
%For instance $C_t$ could have up to a linear growth in time. In this case the decay of $\F(\nu_t)$ will no longer be in $\frac{1}{t}$ but only in $\frac{1}{\log(t)}$ \manote{This seems unlikely if we end up having convergence of $\nu_t$, but who nows.}. However, proving such results would be very involved and it is out of the scope of this study.
%One possible promising condition for \cref{eq:bounded_neg_sobolev} to hold would be if $\mu \ll \nu_0$ and if this property is preserved during the dynamics.


 








