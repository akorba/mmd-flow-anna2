%% LyX 2.3.0 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
\theoremstyle{plain}
\newtheorem{thm}{\protect\theoremname}
\theoremstyle{plain}
\newtheorem{lem}[thm]{\protect\lemmaname}
\ifx\proof\undefined
\newenvironment{proof}[1][\protect\proofname]{\par
	\normalfont\topsep6\p@\@plus6\p@\relax
	\trivlist
	\itemindent\parindent
	\item[\hskip\labelsep\scshape #1]\ignorespaces
}{%
	\endtrivlist\@endpefalse
}
\providecommand{\proofname}{Proof}
\fi
\theoremstyle{plain}
\newtheorem{prop}[thm]{\protect\propositionname}

\makeatother

\usepackage{babel}
\providecommand{\lemmaname}{Lemma}
\providecommand{\propositionname}{Proposition}
\providecommand{\theoremname}{Theorem}

\begin{document}
We consider the sequences $\nu_{k}^{\gamma}$ and $\bar{\nu}_{k}^{\gamma}$
defined by induction: 
\begin{align*}
\nu_{k+1}^{\gamma} & =(I-\gamma\nabla f_{\mu,\nu_{^{k}}^{\gamma}})_{\#}\nu_{k}^{\gamma}\\
\bar{\nu}_{k+1}^{\gamma} & =(I-\gamma\nabla f_{\mu,\nu_{^{\gamma k}}})_{\#}\bar{\nu}_{k}^{\gamma}
\end{align*}
 with $\bar{\nu}_{0}^{\gamma}=\nu_{0}^{\gamma}=\nu_{0}$. We will
first prove that 
\begin{lem}
\label{lem:euler_error_1}For any $k\geq0$:
\[
W_{2}(\nu_{\gamma k},\bar{\nu}_{k}^{\gamma})\le\gamma\frac{C}{L}(e^{k\gamma L}-1)
\]
\end{lem}
\begin{proof}
Let $\pi$ be an optimal coupling between $\bar{\nu}_{k}^{\gamma}$
and $\nu_{\gamma k}$ and $(\bar{X}_{k}$ ,$X_{k})$ a joint sample
from $\pi$. Consider also the joint sample $(\bar{Y},Y)$ obtained:
\end{proof}
\[
Y=X_{k}-\int_{k\gamma}^{(k+1)\gamma}\nabla f_{\mu,\nu_{s}}(u)d\nu_{s}(x),\qquad\bar{Y}=\bar{X}_{k}-\gamma\nabla f_{\mu,\nu_{\gamma k}}(\bar{X}_{k}).
\]
It is easy to see that $Y\sim\nu_{\gamma(k+1)}$ and $\bar{Y}\sim\bar{\nu}_{k+1}^{\gamma}$.
Moreover, using \ref{lem:Taylor-expansion}, the error $\mathcal{E}(Y,X_{k},\gamma)=Y-X_{k}-\gamma\nabla f_{\mu,\nu_{\gamma k}}(X_{k})$
satisfies:

\[
\Vert\mathcal{E}(Y,X_{k},\gamma)\Vert\leq\gamma^{2}C
\]
where $C>0$ depends only on the choice of the kernel. Denoting by
$a_{k}=W_{2}(\nu_{\gamma k},\bar{\nu}_{k}^{\gamma})$, one can therefore
write:

\begin{align*}
a_{k+1}\leq & \mathbb{E_{\pi}}\left[\Vert x-\gamma\nabla f_{\mu,\nu_{\gamma k}}(x)-\bar{x}+\gamma\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})+\mathcal{E}(y,x,\gamma)\Vert^{2}\right]^{\frac{1}{2}}\\
\leq & \mathbb{E_{\pi}}\left[\Vert x-\bar{x}\Vert^{2}\right]^{\frac{1}{2}}+\gamma\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\nu_{\gamma k}}(x)-\nabla f_{\mu,\nu_{\gamma k}}(\bar{x}))\Vert^{2}\right]^{\frac{1}{2}}+\gamma^{2}C\\
\\
\end{align*}
Using that $\nabla f_{\mu,\nu_{\gamma k}}$ is $L$-Lipschitz and
recalling that $\mathbb{E}_{\pi}\left[\Vert x-\bar{x}\Vert^{2}\right]^{\frac{1}{2}}=W_{2}(\nu_{\gamma k},\bar{\nu}_{k}^{\gamma})$
we can get:
\[
a_{k+1}\leq(1+\gamma L)a_{k}+\gamma^{2}C
\]
Using the discrete Gronwall lemma and recalling that $a_{0}=0$ by
definition of $\bar{\nu}_{0}^{\gamma}=\nu_{0}^{\gamma}$ we get:
\[
a_{k}\leq\gamma\frac{C}{L}(e^{k\gamma L}-1)
\]

\begin{lem}
For any $T>0$ and $k$ such that $k\gamma\leq T$
\[
W_{2}(\nu_{k}^{\gamma},\bar{\nu}_{k}^{\gamma})\leq\gamma\frac{C}{\sqrt{2}L}(e^{2TL}-1)^{2}
\]
\end{lem}
%
\begin{proof}
Consider now an optimal coupling $\pi$ between $\bar{\nu}_{k}^{\gamma}$
and $\nu_{k}^{\gamma}$. Similarly to \ref{lem:euler_error_1}, we
denote by $(\bar{X}_{k},X_{k})$ a joint sample from $\pi$ and $\bar{Y},Y$
are obtained using:
\[
\bar{Y}=\bar{X}_{k}-\gamma\nabla f_{\mu,\nu_{\gamma k}}(\bar{X}_{k}),\qquad Y=X_{k}-\gamma\nabla f_{\mu,\nu_{k}^{\gamma}}(X_{k})
\]
We again have that $Y\sim\nu_{k+1}^{\gamma}$ and $\bar{Y}\sim\bar{\nu}_{k+1}^{\gamma}$.
Denoting by $b_{k}=W_{2}(\nu_{k}^{\gamma},\bar{\nu}_{k}^{\gamma})$,
we have:
\begin{align*}
b_{k+1} & \leq\mathbb{E_{\pi}}\left[\Vert x-\gamma\nabla f_{\mu,\nu_{k}^{\gamma}}(x)-\bar{x}+\gamma\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}}\\
 & \leq b_{k}+\gamma\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\nu_{k}^{\gamma}}(x)-\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}}\\
\end{align*}
The term $\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\nu_{k}^{\gamma}}(x)-\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})\Vert^{2}\right]$
can be controlled in the following way:
\begin{align*}
\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\nu_{k}^{\gamma}}(x)-\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}} & \leq(E\left[\Vert\nabla f_{\mu,\nu_{k}^{\gamma}}(x)-\nabla f_{\mu,\nu_{k}^{\gamma}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}}+\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\nu_{k}^{\gamma}}(\bar{x})-\nabla f_{\mu,\bar{\nu}_{k}^{\gamma}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}}+\mathbb{E_{\pi}}\left[\Vert\nabla f_{\mu,\bar{\nu}_{k}^{\gamma}}(\bar{x})-\nabla f_{\mu,\nu_{\gamma k}}(\bar{x})\Vert^{2}\right]^{\frac{1}{2}}\\
 & \leq L(2b_{k}+a_{k})
\end{align*}
where $a_{k}=W_{2}(\bar{\nu}_{k}^{\gamma},\nu_{\gamma k})$ and we
used that $\nabla f_{\mu,\nu}(x)$ is $L$-Lipschitz in both $x$
and $\nu$. Hence we have that:

\[
b_{k+1}\leq(1+2\gamma L)b_{k}+L\gamma a_{k}
\]
But we have by \ref{lem:euler_error_1} that 
\[
a_{k}\leq\gamma\frac{C}{L}(e^{k\gamma L}-1)
\]
Hence, for any $k$ such that $k\gamma\leq T$ we get:
\[
b_{k+1}\leq(1+2\gamma L)b_{k}+C\gamma^{2}(e^{TL}-1).
\]
Using again the dicrete Gronwall lemma, it follows:
\[
b_{k}\leq\gamma\frac{C}{2L}(e^{2TL}-1)^{2}
\]
\end{proof}
%
\begin{prop}
for $T>0$ and $k\leq\frac{T}{\gamma}$ we have that:

\[
W_{2}(\nu_{k}^{\gamma},\nu_{\gamma k})\leq\gamma M(T)
\]
where $M(T)$ is a constant that depends only on $T$.
\end{prop}
Consider the interpolation 
\[
\rho_{t}^{\gamma}=(I-(t-k\gamma)\nabla f_{\mu,\nu_{k}^{\gamma}})_{\#}\nu_{k}^{\gamma}\qquad\forall t\in[k\gamma,(k+1)\gamma)
\]
we will show that 
\[
W_{2}(\rho_{t}^{\gamma},\nu_{t})\leq\gamma(\frac{C}{L}+2M(T))\qquad\forall t\in[0,T]
\]

\begin{proof}
Let $\pi$ be optimal coupling between $\nu_{k}^{\gamma}$ and $\nu_{\gamma k}$
with corresponding samples $(X,Y)$, for $t\in[k\gamma,(k+1)\gamma)$
we have that:
\begin{align*}
Y_{t} & =Y-\int_{k\gamma}^{t}\nabla f_{\mu,\nu_{s}}(u)d\nu_{s}(u)\\
X_{t} & =X-(t-k\gamma)\nabla f_{\mu,\nu_{k}^{\gamma}}(X).
\end{align*}
Using \ref{lem:Taylor-expansion}, we also have $\mathcal{E}(Y_{t},Y,(t-k\gamma))=Y_{t}-Y-(t-k\gamma)\nabla f_{\mu,\nu_{\gamma k}}(Y)$
satisfies:
\[
\mathcal{E}(Y_{t},Y,(t-k\gamma))\leq(t-k\gamma)^{2}C
\]
This allows to write:

\begin{align*}
W_{2}(\rho_{t}^{\gamma},\nu_{t}) & \leq\mathbb{E}\left[\Vert Y-X+(t-k\gamma)(\nabla f_{\mu,\nu_{\gamma k}}(X)-\nabla f_{\mu,\nu_{\gamma k}}(Y))+\mathcal{E}(Y_{t},Y,(t-k\gamma))\Vert^{2}\right]^{\frac{1}{2}}\\
 & \leq W_{2}(\nu_{k}^{\gamma},\nu_{\gamma k})+(t-k\gamma)LW_{2}(\nu_{k}^{\gamma},\nu_{\gamma k})+(t-k\gamma)^{2}C\\
 & \leq(1+\gamma L)W_{2}(\nu_{k}^{\gamma},\nu_{\gamma k})+\gamma^{2}C\\
 & \leq\gamma\left[(1+\gamma L)M(T)+\gamma C\right]
\end{align*}
Hence for $\gamma\leq\frac{1}{L}$ we get 
\[
W_{2}(\rho_{t}^{\gamma},\nu_{t})\leq\gamma(\frac{C}{L}+2M(T)).
\]
\end{proof}
\begin{lem}
\label{lem:Taylor-expansion}Taylor expansion
\end{lem}

\end{document}
